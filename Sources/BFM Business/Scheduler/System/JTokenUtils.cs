//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : JTokenUtils.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation de l'objet JTokenUtils
// Créé le       : 14/07/2015
// Modifié le    : 18/07/2015
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
using Newtonsoft.Json.Linq;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "System"
//*******************************************************************************************************************************
namespace System
	{

	//      #  #####   ###   #   #  #####  #   #
	//      #    #    #   #  #  #   #      ##  #
	//      #    #    #   #  ###    ###    # # #
	//  #   #    #    #   #  #  #   #      #  ##
	//   ###     #     ###   #   #  #####  #   #

	//***************************************************************************************************************************
	// Classe JTokenUtils
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Fournit des méthodes utilisées pour manipuler les JToken.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	internal static class JTokenUtils
		{
		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens la valeur du paramètre.
		/// </summary>
		/// <param name="Self">Objet <b>Self</b> actuel.</param>
		/// <param name="Name">Nom de la propriété.</param>
		/// <returns>Valeur de la propriété.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static T Read<T> ( this JToken Self, string Name )
			{
			//-------------------------------------------------------------------------------------------------------------------
			try
				{
				//---------------------------------------------------------------------------------------------------------------
				JValue Value = Self.Value<JValue> ( Name );

				if ( Value != null && Value.Value != null )
					{
					if ( Value.Value is T )
						return (T)Value.Value;

					if ( typeof (T) == typeof (DateTime) && Value.Value is long )
						{
						object Result = new DateTime ( 1970, 1, 1 ).Add ( TimeSpan.FromSeconds 
						                                    ( (long)Value.Value ) ).ToLocalTime ();
						return (T)Result;
						}
					}
				//---------------------------------------------------------------------------------------------------------------
				}
			//-------------------------------------------------------------------------------------------------------------------
			catch {}
			//-------------------------------------------------------------------------------------------------------------------

			//-------------------------------------------------------------------------------------------------------------------
			return default(T);
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************
	
	} // Fin du namespace "System"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : WebBrowserUtils.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation du contrôle WebBrowserUtils
// Créé le       : 24/02/2015
// Modifié le    : 24/02/2015
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
using Microsoft.Phone.Controls;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "System.Windows.Phone.Controls"
//*******************************************************************************************************************************
namespace System.Windows.Phone.Controls
	{

	//  #   #  #####  ####          ####   ####    ###   #   #   ####  #####  #### 
	//  #   #  #      #   #         #   #  #   #  #   #  #   #  #      #      #   #
	//  #   #  ###    ####   #####  ####   ####   #   #  #   #   ###   ###    #### 
	//  # # #  #      #   #         #   #  #   #  #   #  # # #      #  #      #   #
	//   # #   #####  ####          ####   #   #   ###    # #   ####   #####  #   #

	//***************************************************************************************************************************
	// Classe WebBrowserUtils
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Fournit un bouton de type bar d'outils.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	public static class WebBrowserUtils
		{
		//***********************************************************************************************************************
		/// <summary>
		/// Evalue un script.
		/// </summary>
		/// <param name="Self">.</param>
		/// <param name="Str">.</param>
		/// <returns><b>Object</b> contenant le résultat de l'appel.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static object Eval ( this WebBrowser Self, string Script )
			{
			//-------------------------------------------------------------------------------------------------------------------
			try { return Self.InvokeScript ( "eval", new string[] { Script } ); } catch {}

			return null;
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Evalue un script.
		/// </summary>
		/// <param name="Self">.</param>
		/// <param name="Str">.</param>
		/// <returns><b>Object</b> contenant le résultat de l'appel.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static void SetCookie ( this WebBrowser Self, string Name, string Value, string Domain )
			{
			//-------------------------------------------------------------------------------------------------------------------
			try
				{
				string CookieJs = "document.cookie = '{0}={1}; path=/; domain={2}'";
				
				Self.InvokeScript ( "eval", new string[] { string.Format ( CookieJs, Name, 
				                          System.Net.HttpUtility.UrlEncode ( Value ), Domain ) } );
				}
			catch {}
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************

	} // Fin du namespace "System.Windows.Phone.Controls"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************

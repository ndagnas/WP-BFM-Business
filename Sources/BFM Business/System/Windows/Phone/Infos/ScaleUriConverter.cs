//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : ScaleUriConverter.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation de l'objet ScaleUriConverter
// Créé le       : 23/02/2015
// Modifié le    : 23/02/2015
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
using System.IO;
using System.Windows.Data;
using System.Globalization;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "System.Windows.Phone.Infos"
//*******************************************************************************************************************************
namespace System.Windows.Phone.Infos
	{

	//   ####   ###    ###   #      #####         #   #  ####   #
	//  #      #   #  #   #  #      #             #   #  #   #  #
	//   ###   #      #####  #      ###    #####  #   #  ####   #
	//      #  #   #  #   #  #      #             #   #  #   #  #
	//  ####    ###   #   #  #####  #####          ###   #   #  #

	//***************************************************************************************************************************
	// Classe ScaleUri & ScaleUriConverter
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Permet de gérer les différentes définitions.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	public class ScaleUriConverter : IValueConverter
		{
		//-----------------------------------------------------------------------------------------------------------------------
		// Section des Attributs
		//-----------------------------------------------------------------------------------------------------------------------
		private static string CurrentRessString = string.Empty;
		//-----------------------------------------------------------------------------------------------------------------------

		//***********************************************************************************************************************
		/// <summary>
		/// Constructeur statique de l'objet <b>ScaleFactor</b>.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		static ScaleUriConverter ()
			{
			//-------------------------------------------------------------------------------------------------------------------
			switch ( DeviceInfos.ScaleFactor )
				{
				//-----------------------------------------------------------------------------------------------------------
				case Factor.Scale_WVGA  : CurrentRessString = "wvga" ; break;
				case Factor.Scale_720P  : CurrentRessString = "720p" ; break;
				case Factor.Scale_WXGA  : CurrentRessString = "wxga" ; break;
				case Factor.Scale_1080P : CurrentRessString = "1080p"; break;
				default                 : CurrentRessString = "wvga" ; break;
				//-----------------------------------------------------------------------------------------------------------
				}
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Convertit le chemin standart en chemin lié à la définition courante.
		/// </summary>
		/// <param name="UriString">Lien à convertir.</param>
		/// <returns>Lien convertis.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static string Convert ( string UriString )
			{
			//-------------------------------------------------------------------------------------------------------------------
			string Extention = Path.GetExtension ( UriString );

			return UriString.Replace ( Extention, string.Format ( "-{0}{1}", CurrentRessString, Extention ) );
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Modifie les données sources avant de les passer à la cible en vue de leur affichage 
		/// dans l'interface utilisateur.
		/// </summary>
		/// <param name="Value">Les données sources passées à la cible.</param>
		/// <param name="TargetType">
		/// Type de données attendu par la propriété de dépendance cible.
		/// </param>
		/// <param name="Parameter">
		/// Un paramètre optionnel à utiliser dans la logique du convertisseur.
		/// </param>
		/// <param name="Culture">La culture de la conversion.</param>
		/// <returns>La valeur à passer à la propriété de dépendance cible.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public object Convert ( object Value, Type TargetType, object Parameter, CultureInfo Culture )
			{
			//-------------------------------------------------------------------------------------------------------------------
			if ( Value is string ) Value = Convert ( (string)Value );
		
			return Value;
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Modifie les données cibles avant de les passer à l'objet source.
		/// </summary>
		/// <param name="Value">Les données cibles passées à la source.</param>
		/// <param name="TargetType">Type de données attendu par l'objet source.</param>
		/// <param name="Parameter">
		/// Un paramètre optionnel à utiliser dans la logique du convertisseur.
		/// </param>
		/// <param name="Culture">La culture de la conversion.</param>
		/// <returns>La valeur à passer à l'objet source.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public object ConvertBack ( object Value, Type TargetType, object Parameter, CultureInfo Culture )
			{ throw new NotSupportedException (); }
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************

	} // Fin du namespace "System.Windows.Phone.Infos"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : VersionUtils.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation de l'objet VersionUtils
// Créé le       : 21/06/2013
// Modifié le    : 21/06/2013
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
using System.Reflection;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "System"
//*******************************************************************************************************************************
namespace System
	{

	//  #   #  #####  ####    ####  #   ###   #   #         #   #  #####  #  #       ####
	//  #   #  #      #   #  #      #  #   #  ##  #         #   #    #    #  #      #    
	//  #   #  ###    ####    ###   #  #   #  # # #  #####  #   #    #    #  #       ### 
	//   # #   #      #   #      #  #  #   #  #  ##         #   #    #    #  #          #
	//    #    #####  #   #  ####   #   ###   #   #          ###     #    #  #####  #### 

	//***************************************************************************************************************************
	// Classe VersionUtils
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Fournit des méthodes utilisées pour manipuler les version.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	public static class VersionUtils
		{
		//-----------------------------------------------------------------------------------------------------------------------
		// Section des Attributs
		//-----------------------------------------------------------------------------------------------------------------------
		private static Version FCurrent = null;
		//-----------------------------------------------------------------------------------------------------------------------

		//***********************************************************************************************************************
		// Obtiens la version de l'application
		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens la version de l'application.
		/// </summary>
		/// <returns>Objet <b>Version</b> contenant la version de l'application.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static Version Current
			{
			//-------------------------------------------------------------------------------------------------------------------
			get
				{
				//---------------------------------------------------------------------------------------------------------------
				if ( VersionUtils.FCurrent == null )
					{
					//-----------------------------------------------------------------------------------------------------------
					Version Vr = new Version ( 0, 0, 0, 0 );
					//-----------------------------------------------------------------------------------------------------------

					//-----------------------------------------------------------------------------------------------------------
					try
						{
						//-------------------------------------------------------------------------------------------------------
						Assembly Assembly = Assembly.GetExecutingAssembly ();
						//-------------------------------------------------------------------------------------------------------

						//-------------------------------------------------------------------------------------------------------
						if ( Assembly != null )
							{
							string[] AssemblyName = Assembly.FullName.Split ( ',' );

							if ( AssemblyName.Length > 1 )
								Vr = new Version ( AssemblyName[1].Split('=')[1] );
							}
						//-------------------------------------------------------------------------------------------------------
						}
					//-----------------------------------------------------------------------------------------------------------
					catch {}
					//-----------------------------------------------------------------------------------------------------------

					//-----------------------------------------------------------------------------------------------------------
					VersionUtils.FCurrent = Vr;
					//-----------------------------------------------------------------------------------------------------------
					}
				//---------------------------------------------------------------------------------------------------------------

				//---------------------------------------------------------------------------------------------------------------
				return VersionUtils.FCurrent;
				//---------------------------------------------------------------------------------------------------------------
				}
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************
	
	} // Fin du namespace "System"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : AsyncCompletedEventArgs.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation de l'objet permettant de récupérer le contenue distant
// Créé le       : 15/01/2015
// Modifié le    : 03/07/2015
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
using System.IO;
using System.Net;
using System.ComponentModel;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "System.Web"
//*******************************************************************************************************************************
namespace System.Web
	{

	//   ###    ####  #   #  #   #   ###          #####  #   #  #####  #   #  #####
	//  #   #  #       # #   ##  #  #   #         #      #   #  #      ##  #    #  
	//  #####   ###     #    # # #  #      #####  ###    #   #  ###    # # #    #  
	//  #   #      #    #    #  ##  #   #         #       # #   #      #  ##    #  
	//  #   #  ####     #    #   #   ###          #####    #    #####  #   #    #  

	//***************************************************************************************************************************
	// Classe AsyncCompletedEventArgs
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Fournit des données pour l'événement <b>AsyncCompletedEventHandler</b>.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	sealed class AsyncCompletedEventArgs : CancelEventArgs
		{
		//***********************************************************************************************************************
		/// <summary>
		/// Initialise une nouvelle instance de l'objet<b>AsyncCompletedEventArgs</b>.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public AsyncCompletedEventArgs ( HttpWebRequest  Request         , 
		                                 bool            Cancelled       , 
		                                 Exception       Exception       , 
										 bool            IsRedirected    , 
										 int             RedirectionCount, 
										 HttpWebResponse Response        , 
										 Uri             ResponseUri     , 
										 Stream          Stream          , 
										 object          UserToken       ) : base ( false )
			{
			//-------------------------------------------------------------------------------------------------------------------
			this.Cancelled        = Cancelled;
			this.Exception        = Exception;
			this.IsRedirected     = IsRedirected;
			this.Request          = Request;
			this.RedirectionCount = RedirectionCount;
			this.Response         = Response;
			this.ResponseUri      = ResponseUri;
			this.Stream           = Stream;
			this.UserToken        = UserToken;
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtient une valeur qui indique si la requête web a été annulée.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public bool Cancelled { get; private set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'exception générée par à la requête web.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Exception Exception { get; private set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Indique si demande est redirigée.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public bool IsRedirected { get; private set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtient le nombre de redirections effectués associé à la demande.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public int RedirectionCount { get; private set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'objet <b>HttpWebRequest</b> associé à la requête.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public HttpWebRequest Request { get; private set; }
		//***********************************************************************************************************************
		
		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'objet <b>HttpWebResponse</b> associé à la réponse de la requête.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public HttpWebResponse Response { get; private set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'URI de la ressource Internet qui a réellement répondu à la requête.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Uri ResponseUri { get; set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtient les données qui ont étés téléchargées.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Stream Stream { get; private set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Données du client.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public object UserToken { get; private set; }
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************

	} // Fin du namespace "System.Web"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************
